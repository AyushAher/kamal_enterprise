{% extends 'shop/base.html' %}

{% block body %}
{% load static %}


<!-- carousel -->
<div class="w3l_banner_nav_right">
    <section class="slider">
        <div class="flexslider">
            <ul class="slides">
                <li>
                    <div class="w3l_banner_nav_right_bannekr">
                        <img src=" {%static 'shop/images/products/all.jpg'%} " alt="">
                    </div>
                </li>
            </ul>
        </div>

    </section>
    <!-- flexSlider -->
    <link rel="stylesheet" href="{% static 'shop/css/flexslider.css'%}">
    <script defer src="{% static 'shop/js/jquery.flexslider.js'%}" type="text/javascript"></script>
    <script type="text/javascript">
        $(window).load(function () {
            $('.flexslider').flexslider({
                animation: "slide",
                start: function (slider) {
                    $('body').removeClass('loading');
                }
            });
        });
    </script>
    <!-- //flexSlider -->
</div>

<div class="clearfix"></div>
</div>
<!-- banner -->
<div class="banner_bottom">
    <div class="wthree_banner_bottom_left_grid_sub">
    </div>
    <div class="wthree_banner_bottom_left_grid_sub1">
        <div class="col-md-4 wthree_banner_bottom_left">
            <div class="wthree_banner_bottom_left_grid">
                <img src="{%static 'shop/images/4.jpg'%}" alt=" " class="img-responsive" />
                <div class="wthree_banner_bottom_left_grid_pos">
                    <h4>Discount Offer <span>25%</span></h4>
                </div>
            </div>
        </div>
        <div class="col-md-4 wthree_banner_bottom_left">
            <div class="wthree_banner_bottom_left_grid">
                <img src="{%static 'shop/images/5.jpg'%}" alt=" " class="img-responsive" />
                <div class="wthree_banner_btm_pos">
                    <h3>introducing <span>best store</span> for <i>Cleaning Items</i></h3>
                </div>
            </div>
        </div>
        <div class="col-md-4 wthree_banner_bottom_left">
            <div class="wthree_banner_bottom_left_grid">
                <img src="{%static 'shop/images/6.jpg'%}" alt=" " class="img-responsive" />
                <div class="wthree_banner_btm_pos1">
                    <h3>Save <span>Upto</span>₹100</h3>
                </div>
            </div>
        </div>
        <div class="clearfix"> </div>
    </div>
    <div class="clearfix"> </div>
</div>
<!-- top-brands -->
<div class="top-brands">
    <div class="container">
        <h3>Households</h3>
        <div class="agile_top_brands_grids">


            {% for i in page.object_list %}
            <div style="margin-top: 25px;" class="col-md-4 top_brand_left">
                <div class="hover14 column">
                    <div class="agile_top_brand_left_grid">
                        <div class="agile_top_brand_left_grid_pos">
                        </div>
                        <div class="agile_top_brand_left_grid1">
                            <figure>
                                <div class="snipcart-item block">

                                    <div class="col-xs-3 col-sm-3 col-md-3">
                                        <div class="card align-items-center" style="width: 18rem;">
                                            <img src="{{i.image}}" alt=" " class="card-img-top img-responsive" />
                                            <div class="card-body">
                                                <h5 style="font-size: 25px; margin-bottom: 10px; margin-top: 10px;"
                                                    class="card-title" id="namepr{{i.id}}">{{i.name}}</h5>
                                                <h6 class="card-title cart" style="margin-bottom: -1px; font-size: 20px;">Price: ₹<span
                                                        id="pricepr{{i.id}}">{{i.price}}</span></h6>
                                                <span id="divpr{{i.id}}" class="divpr">
                                                    <button id="pr{{i.id}}" class="btn btn-primary cart">Add To
                                                        Cart</button>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </figure>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
            
            <div class="clearfix"> </div>
        </div>
    </div>
</div>

<div class="top-brands">
    <div class="container">
        <h3>Dryfruits</h3>
        <div class="agile_top_brands_grids">


            {% for i in page1.object_list %}
            <div style="margin-top: 25px;" class="col-md-4 top_brand_left">
                <div class="hover14 column">
                    <div class="agile_top_brand_left_grid">
                        <div class="agile_top_brand_left_grid_pos">
                        </div>
                        <div class="agile_top_brand_left_grid1">
                            <figure>
                                <div class="snipcart-item block">

                                    <div class="col-xs-3 col-sm-3 col-md-3">
                                        <div class="card align-items-center" style="width: 18rem;">
                                            <img src="/{{i.image}}" alt=" " class="card-img-top img-responsive" />
                                            <div class="card-body">
                                                <h5 style="font-size: 25px; margin-bottom: 10px; margin-top: 10px;"
                                                    class="card-title" id="namepr{{i.id}}">{{i.name}}</h5>
                                                <h5 class="card-title cart" style="margin-bottom: -1px; ">Price: ₹<span
                                                        id="pricepr{{i.id}}">{{i.price}}</span></h5>
                                                <span id="divpr{{i.id}}" class="divpr">
                                                    <button id="pr{{i.id}}" class="btn btn-primary cart">Add To
                                                        Cart</button>
                                                </span>
                                                <!-- <a href="/shop/products/{{i.id}}"><button id="qv{{i.id}}" class="btn btn-primary cart">QuickView</button></a> -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </figure>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
            <div class="clearfix"> </div>
        </div>
    </div>
</div>
<!-- //top-brands -->
{% endblock body %}

{% block js %}
<script>
    // Find out the cart items from localStorage
    if (localStorage.getItem('cart') == null) {
        var cart = {};
    } else {
        cart = JSON.parse(localStorage.getItem('cart'));
        updateCart(cart);
    }

    // If the add to cart button is clicked, add/increment the item
    //$('.cart').click(function() {
    $('.divpr').on('click', 'button.cart', function () {

        var idstr = this.id.toString();
        var name;
        var price;

        if (cart[idstr] != undefined) {
            qty = cart[idstr][0] + 1;
        } else {
            qty = 1;
            name = document.getElementById('name' + idstr).innerHTML;
            price = document.getElementById('price' + idstr);
            console.log(idstr);
            console.log(price);
            cart[idstr] = [qty, name, price.innerHTML];

        }
        updateCart(cart);

    });

    function clearCart() {
        cart = JSON.parse(localStorage.getItem('cart'));
        for (var item in cart) {
            document.getElementById('div' + item).innerHTML = '<button id="' + item + '" class="btn btn-primary cart">Add To Cart</button>'
        }
        localStorage.clear();
        cart = {};
        updateCart(cart);
    }

    function updateCart(cart) {
        var sum = 0;
        for (var item in cart) {
            sum = sum + cart[item][0];
            document.getElementById('div' + item).innerHTML = "<button id='minus" + item + "' class='btn btn-primary minus'>-</button> <span id='val" + item + "''>" + cart[item][0] + "</span> <button id='plus" + item + "' class='btn btn-primary plus'> + </button>";
        }
        localStorage.setItem('cart', JSON.stringify(cart));
        document.getElementById('cart').innerHTML = sum;
        console.log(cart);
    }

    // If plus or minus button is clicked, change the cart as well as the display value
    $('.divpr').on("click", "button.minus", function () {
        a = this.id.slice(7,);
        cart['pr' + a][0] = cart['pr' + a][0] - 1;
        cart['pr' + a][0] = Math.max(0, cart['pr' + a][0]);
        if (cart['pr' + a][0] == 0) {
            document.getElementById('divpr' + a).innerHTML = '<button id="pr' + a + '" class="btn btn-primary cart">Add to Cart</button>';
            delete cart['pr' + a];
        }
        else {
            document.getElementById('valpr' + a).innerHTML = cart['pr' + a][0];
        }
        updateCart(cart);

    });

    $('.divpr').on("click", "button.plus", function () {
        a = this.id.slice(6,);
        cart['pr' + a][0] = cart['pr' + a][0] + 1;
        document.getElementById('valpr' + a).innerHTML = cart['pr' + a][0];
        updateCart(cart);
    });
</script>
{% endblock js %}